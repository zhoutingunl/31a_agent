# Agent é¡¹ç›® -- æ™ºèƒ½å¯¹è¯åŠ©æ‰‹

ä¸€ä¸ªåŸºäº **LangChain** å’Œ **LangGraph** çš„æ™ºèƒ½ Agent ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·è¾“å…¥è‡ªåŠ¨è§„åˆ’ä»»åŠ¡æµç¨‹å¹¶è°ƒç”¨å·¥å…·å®Œæˆå¤æ‚ä»»åŠ¡ã€‚

> ğŸ‰ **MVP ç‰ˆæœ¬å·²å®Œæˆï¼** åŒ…å«åŸºç¡€å¯¹è¯ã€å·¥å…·è°ƒç”¨ï¼ˆMySQLï¼‰ã€æµå¼å“åº”å’Œ Web ç•Œé¢ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# æ¿€æ´» Conda ç¯å¢ƒ
conda activate transformer

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
# å¤åˆ¶ .env.example ä¸º .envï¼Œå¡«å…¥ä½ çš„é…ç½®
```

### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“å’Œè¡¨
python scripts/init_db.py
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
python scripts/run_dev.py

# æ–¹å¼2ï¼šç›´æ¥ä½¿ç”¨ uvicorn
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. è®¿é—®æœåŠ¡

- **Web ç•Œé¢**: http://localhost:8000/
- **API æ–‡æ¡£**: http://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### å·²å®ç°åŠŸèƒ½ï¼ˆv0.1.0ï¼‰

1. **æ™ºèƒ½å¯¹è¯** âœ…
   - æ”¯æŒå¤šè½®å¯¹è¯
   - ä¸Šä¸‹æ–‡è®°å¿†ï¼ˆæœ€è¿‘20æ¡æ¶ˆæ¯ï¼‰
   - æµå¼å’Œéæµå¼å“åº”

2. **å·¥å…·è°ƒç”¨** âœ…  
   - MySQL æ•°æ®åº“æŸ¥è¯¢
   - è‡ªåŠ¨å·¥å…·é€‰æ‹©å’Œè°ƒç”¨
   - åŸºäº **LangGraph create_react_agent**ï¼ˆå¼€æºæ¡†æ¶ï¼‰

3. **ä¼šè¯ç®¡ç†** âœ…
   - åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä¼šè¯
   - ä¼šè¯åˆ—è¡¨å’Œè¯¦æƒ…
   - è½¯åˆ é™¤

4. **Web ç•Œé¢** âœ…
   - ç®€æ´ç°ä»£çš„å¯¹è¯ç•Œé¢
   - æ”¯æŒä¼šè¯åˆ‡æ¢
   - æµå¼è¾“å‡ºå¯è§†åŒ–

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å¼€æºæ¡†æ¶ï¼ˆMIT Licenseï¼Œå¯å•†ç”¨ï¼‰

| æ¡†æ¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **LangChain** | 0.3.27 | LLM é€‚é…ã€å·¥å…·æ ‡å‡† |
| **LangGraph** | 0.6.10 | Agent å·¥ä½œæµã€ä»»åŠ¡è§„åˆ’ â­ |
| **FastAPI** | 0.119.0 | Web æ¡†æ¶ |
| **SQLAlchemy** | 2.0.44 | ORM |
| **Pydantic** | 2.11.9 | æ•°æ®éªŒè¯ |

### å…­å±‚æ¶æ„

```
Web ç•Œé¢ â†’ API å±‚ â†’ Service å±‚ â†’ DAO å±‚ â†’ Models å±‚ â†’ æ•°æ®åº“
            â†“
        Agent å±‚ï¼ˆLangGraphï¼‰â†’ å·¥å…·å±‚ï¼ˆLangChain Toolsï¼‰
```

---

## ğŸ¤– Agent èƒ½åŠ›å±•ç¤º

### ç¤ºä¾‹1ï¼šç®€å•å¯¹è¯

**ç”¨æˆ·**: ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ã€‚  
**Agent**: ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ æŸ¥è¯¢æ•°æ®åº“ã€åˆ†ææ•°æ®...

### ç¤ºä¾‹2ï¼šè‡ªåŠ¨å·¥å…·è°ƒç”¨ï¼ˆLangGraphï¼‰

**ç”¨æˆ·**: è¯·å¸®æˆ‘æŸ¥è¯¢æ•°æ®åº“ä¸­æœ‰å¤šå°‘ä¸ªç”¨æˆ·ï¼Ÿ  

**Agent æ‰§è¡Œæµç¨‹**ï¼ˆè‡ªåŠ¨ï¼‰:
1. ğŸ¤” ç†è§£æ„å›¾ï¼šéœ€è¦æŸ¥è¯¢ç”¨æˆ·æ•°é‡
2. ğŸ”§ è°ƒç”¨å·¥å…·1ï¼š`SHOW TABLES`ï¼ˆå…ˆçœ‹æœ‰å“ªäº›è¡¨ï¼‰
3. ğŸ”§ è°ƒç”¨å·¥å…·2ï¼š`SELECT COUNT(*) FROM user`ï¼ˆç»Ÿè®¡ç”¨æˆ·ï¼‰
4. ğŸ’¬ è¿”å›ç»“æœï¼šæ ¹æ®æŸ¥è¯¢ç»“æœï¼Œæ•°æ®åº“ä¸­ç›®å‰æœ‰ **1 ä¸ªç”¨æˆ·**ã€‚

> è¿™å°±æ˜¯ LangGraph çš„å¨åŠ›ï¼š**è‡ªåŠ¨å¤šè½®å·¥å…·è°ƒç”¨å’Œå†³ç­–**ï¼

---

## ğŸ“– é¡¹ç›®æ–‡æ¡£

å®Œæ•´æ–‡æ¡£ä½äº `docs/` ç›®å½•ï¼š

- [ğŸ“‹ è¿­ä»£è®¡åˆ’](docs/è¿­ä»£è®¡åˆ’.md) - 8ä¸ªé˜¶æ®µçš„è¯¦ç»†è§„åˆ’
- [ğŸ—ï¸ é¡¹ç›®æ¶æ„](docs/é¡¹ç›®æ¶æ„.md) - ç³»ç»Ÿæ¶æ„å’Œç›®å½•ç»“æ„
- [ğŸ“ å¼€å‘è§„èŒƒ](docs/å¼€å‘è§„èŒƒ.md) - ä»£ç è§„èŒƒå’Œæœ€ä½³å®è·µ
- [ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡](docs/æ•°æ®åº“è®¾è®¡.md) - æ•°æ®åº“è¡¨ç»“æ„å’Œ SQL
- [ğŸ“Š å®æ–½è¿›åº¦](docs/å®æ–½è¿›åº¦.md) - è¯¦ç»†çš„æ‰§è¡Œè®°å½•
- [ğŸ‰ MVPå®ŒæˆæŠ¥å‘Š](docs/MVPå®ŒæˆæŠ¥å‘Š.md) - é¡¹ç›®æ€»ç»“
- [ğŸ“¦ å¼€æºæ¡†æ¶ä½¿ç”¨è¯´æ˜](docs/å¼€æºæ¡†æ¶ä½¿ç”¨è¯´æ˜.md) - å¼€æºç»„ä»¶è¯´æ˜

---

## ğŸ› ï¸ å·²å®ç°çš„å·¥å…·

| å·¥å…·åç§° | åŠŸèƒ½ | å®‰å…¨é™åˆ¶ |
|---------|------|---------|
| mysql_query | MySQL æ•°æ®åº“æŸ¥è¯¢ | ä»…æ”¯æŒ SELECT/SHOW/DESC |

### å·¥å…·ä½¿ç”¨ç¤ºä¾‹

```python
from app.tools.manager import tool_manager
from app.tools.database.mysql_tool import MySQLQueryTool

# æ³¨å†Œå·¥å…·
mysql_tool = MySQLQueryTool()
tool_manager.register_tool(mysql_tool)

# æ‰§è¡Œå·¥å…·
result = tool_manager.execute_tool(
    "mysql_query",
    query="SELECT * FROM user LIMIT 5"
)
```

---

## ğŸ¯ å¦‚ä½•æ·»åŠ æ–°å·¥å…·

åŸºäº LangChain æ ‡å‡†ï¼Œæ·»åŠ æ–°å·¥å…·éå¸¸ç®€å•ï¼š

```python
from langchain_core.tools import BaseTool
from pydantic import BaseModel, Field

# 1. å®šä¹‰å·¥å…·è¾“å…¥
class YourToolInput(BaseModel):
    param: str = Field(..., description="å‚æ•°è¯´æ˜")

# 2. å®ç°å·¥å…·ç±»
class YourTool(BaseTool):
    name = "your_tool_name"
    description = "å·¥å…·æè¿°"
    args_schema = YourToolInput
    
    def _run(self, param: str):
        # å®ç°å·¥å…·é€»è¾‘
        return "ç»“æœ"

# 3. æ³¨å†Œå·¥å…·
tool_manager.register_tool(YourTool())
```

**LangGraph Agent ä¼šè‡ªåŠ¨è¯†åˆ«å’Œè°ƒç”¨æ–°å·¥å…·**ï¼Œæ— éœ€ä¿®æ”¹ Agent ä»£ç ï¼

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **LLM å“åº”æ—¶é—´**: 3-4ç§’ï¼ˆéæµå¼ï¼‰
- **æµå¼é¦–å­—èŠ‚**: çº¦1.5ç§’
- **å·¥å…·è°ƒç”¨å»¶è¿Ÿ**: < 100ms
- **æ•°æ®åº“æŸ¥è¯¢**: 5-10ms
- **å¹¶å‘æ”¯æŒ**: çº¦50å¹¶å‘ï¼ˆå•æœºï¼‰

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
customer/
â”œâ”€â”€ app/                    # åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ utils/             # â­ å…¬ç”¨ç»„ä»¶ï¼ˆconfig, logger, exceptionsï¼‰
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹ï¼ˆSQLAlchemyï¼‰
â”‚   â”œâ”€â”€ dao/               # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ core/              # Agent æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ llm/          # LLM é€‚é…ï¼ˆLangChainï¼‰
â”‚   â”‚   â”œâ”€â”€ agent/        # Agent å®ç°ï¼ˆLangGraphï¼‰â­
â”‚   â”‚   â””â”€â”€ memory/       # è®°å¿†ç®¡ç†
â”‚   â”œâ”€â”€ tools/             # å·¥å…·å±‚ï¼ˆLangChain Toolsï¼‰â­
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±ï¼ˆFastAPIï¼‰
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â””â”€â”€ schemas/           # æ•°æ®æ ¡éªŒï¼ˆPydanticï¼‰
â”œâ”€â”€ config/                # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                  # é¡¹ç›®æ–‡æ¡£ï¼ˆ6ä¸ªæ–‡æ¡£ï¼‰
â”œâ”€â”€ scripts/               # è„šæœ¬æ–‡ä»¶ï¼ˆ7ä¸ªè„šæœ¬ï¼‰
â”œâ”€â”€ web/                   # Web ç•Œé¢
â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ requirements.txt       # ä¾èµ–æ¸…å•
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

---

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•è„šæœ¬ï¼š

```bash
# æµ‹è¯•å…¬ç”¨ç»„ä»¶
python scripts/test_utils.py

# æµ‹è¯•æ•°æ®åº“å±‚
python scripts/test_dao_service.py

# æµ‹è¯• LLM
python scripts/test_llm.py

# æµ‹è¯•å·¥å…·ç³»ç»Ÿ
python scripts/test_tools.py

# æµ‹è¯• LangGraph Agent
python scripts/test_tool_agent.py

# æµ‹è¯• API
python scripts/test_api.py
python scripts/test_conversation_api.py
python scripts/test_chat_api.py
```

---

## ğŸ”® åç»­è®¡åˆ’

### ç¬¬11é˜¶æ®µï¼šæ›´å¤šå·¥å…·ï¼ˆè®¡åˆ’ä¸­ï¼‰
- [ ] æ–‡ä»¶æ“ä½œå·¥å…·
- [ ] PowerShell å·¥å…·
- [ ] HTTP è¯·æ±‚å·¥å…·
- [ ] Playwright å·¥å…·

### ç¬¬12é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆè®¡åˆ’ä¸­ï¼‰
- [ ] è®°å¿†å‹ç¼©ï¼ˆLLM æ‘˜è¦ï¼‰
- [ ] å¤šæ¨¡æ€æ”¯æŒï¼ˆå›¾ç‰‡ç†è§£ï¼‰
- [ ] RAG çŸ¥è¯†åº“ï¼ˆChromaï¼‰
- [ ] å¤æ‚ä»»åŠ¡è§„åˆ’

---

## ğŸ“‹ å¼€å‘è§„èŒƒ

å¼€å‘å‰è¯·é˜…è¯»ï¼š
- [å¼€å‘è§„èŒƒ](docs/å¼€å‘è§„èŒƒ.md) - ä»£ç è§„èŒƒã€å‘½åè§„åˆ™
- [é¡¹ç›®æ¶æ„](docs/é¡¹ç›®æ¶æ„.md) - æ¶æ„è®¾è®¡ã€ç›®å½•è¯´æ˜

**æ ¸å¿ƒè§„èŒƒ**:
1. æ‰€æœ‰ä»£ç å¿…é¡»æœ‰ä¸­æ–‡æ³¨é‡Š
2. ä½¿ç”¨ç»Ÿä¸€çš„æ—¥å¿—å·¥å…·ï¼ˆ`app.utils.logger`ï¼‰
3. éµå¾ª PEP 8 ä»£ç é£æ ¼
4. ä¼˜å…ˆä½¿ç”¨å…¬ç”¨ç»„ä»¶

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼ˆå…¨éƒ¨ MIT Licenseï¼‰ï¼š

- [LangChain](https://python.langchain.com/) - LLM åº”ç”¨å¼€å‘æ¡†æ¶
- [LangGraph](https://langchain-ai.github.io/langgraph/) - Agent å·¥ä½œæµæ¡†æ¶ â­
- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£ Web æ¡†æ¶
- [SQLAlchemy](https://www.sqlalchemy.org/) - Python ORM
- [Pydantic](https://docs.pydantic.dev/) - æ•°æ®éªŒè¯

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ‰€æœ‰å¼€æºç»„ä»¶å‡ä¸º MIT Licenseï¼Œ**å¯å•†ç”¨**ã€‚

---

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£æˆ–æäº¤ Issueã€‚

---

**æœ€åæ›´æ–°**: 2025-10-12  
**ç‰ˆæœ¬**: v0.1.0ï¼ˆMVP + å·¥å…·ç³»ç»Ÿï¼‰  
**çŠ¶æ€**: âœ… å¯ç”¨  
**å¼€æºæ¡†æ¶**: LangChain + LangGraph + FastAPI
